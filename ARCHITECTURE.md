# ğŸ“Š Cáº¤U TRÃšC & LUá»’NG HOáº T Äá»˜NG BOT

## ğŸ—ï¸ Kiáº¿n TrÃºc Há»‡ Thá»‘ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     TELEGRAM USERS                          â”‚
â”‚              (Gá»­i lá»‡nh & nháº­n tÃ­n hiá»‡u)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BOT.PY (Main Logic)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Command Handlers: /start, /stop, /status, /stats    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Periodic Job: Check signals every N seconds         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                        â”‚
                 â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RSI_INDICATOR.PY       â”‚   â”‚  EXCHANGE_CLIENT.PY          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Calculate RSI     â”‚  â”‚   â”‚  â”‚ BinanceClient          â”‚  â”‚
â”‚  â”‚ Calculate EMA9    â”‚  â”‚   â”‚  â”‚  - Get BTC/USD data    â”‚  â”‚
â”‚  â”‚ Calculate WMA45   â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”‚ TwelveDataClient       â”‚  â”‚
â”‚  â”‚ 4-Step BUY Logic  â”‚  â”‚   â”‚  â”‚  - Get XAU/USD data    â”‚  â”‚
â”‚  â”‚ 4-Step SELL Logic â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
â”‚  â”‚ Signal Detection  â”‚  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                                             â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   EXTERNAL APIs              â”‚
                              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                              â”‚  â”‚ Binance API (Free)     â”‚  â”‚
                              â”‚  â”‚  - Real-time BTC data  â”‚  â”‚
                              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                              â”‚  â”‚ Twelve Data API        â”‚  â”‚
                              â”‚  â”‚  - XAU/USD forex data  â”‚  â”‚
                              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Luá»“ng Xá»­ LÃ½ TÃ­n Hiá»‡u

```
START
  â”‚
  â”œâ”€â–º [Every N seconds] Timer triggers check_signals()
  â”‚
  â”œâ”€â–º For each Symbol (BTCUSD, XAUUSD):
  â”‚     â”‚
  â”‚     â”œâ”€â–º For each Timeframe (15m, 1h):
  â”‚     â”‚     â”‚
  â”‚     â”‚     â”œâ”€â–º Fetch price data (Klines)
  â”‚     â”‚     â”‚     â”œâ”€ Binance API (if BTCUSD)
  â”‚     â”‚     â”‚     â””â”€ Twelve Data API (if XAUUSD)
  â”‚     â”‚     â”‚
  â”‚     â”‚     â”œâ”€â–º Update indicator with new data
  â”‚     â”‚     â”‚     â”œâ”€ Calculate RSI
  â”‚     â”‚     â”‚     â”œâ”€ Calculate EMA9 of RSI
  â”‚     â”‚     â”‚     â”œâ”€ Calculate WMA45 of RSI
  â”‚     â”‚     â”‚     â””â”€ Process 4-step logic
  â”‚     â”‚     â”‚
  â”‚     â”‚     â”œâ”€â–º Check for new signals
  â”‚     â”‚     â”‚     â”œâ”€ BUY #1? (RSI cross up EMA9)
  â”‚     â”‚     â”‚     â”œâ”€ BUY #2? (RSI cross up WMA45)
  â”‚     â”‚     â”‚     â”œâ”€ SELL #1? (RSI cross down EMA9)
  â”‚     â”‚     â”‚     â””â”€ SELL #2? (RSI cross down WMA45)
  â”‚     â”‚     â”‚
  â”‚     â”‚     â””â”€â–º If new signal detected:
  â”‚     â”‚           â””â”€ Send alert to all subscribers
  â”‚     â”‚
  â”‚     â””â”€â–º Continue to next timeframe
  â”‚
  â””â”€â–º Loop continues...
```

## ğŸ“ Chi Tiáº¿t 4 BÆ°á»›c Setup

### ğŸŸ¢ BUY SETUP (Trend Reversal Down â†’ Up)

```
Step 1: RSI â‰¥ 80 (Overbought)
   â”‚
   â–¼
Step 2: RSI crossunder EMA9
   â”‚  (RSI giáº£m, cáº¯t xuá»‘ng dÆ°á»›i EMA9)
   â–¼
Step 3: RSI crossunder WMA45
   â”‚  (RSI tiáº¿p tá»¥c giáº£m, cáº¯t xuá»‘ng dÆ°á»›i WMA45)
   â–¼
Step 4: EMA9 crossunder WMA45
   â”‚  (EMA9 cÅ©ng cáº¯t xuá»‘ng dÆ°á»›i WMA45)
   â–¼
ğŸŸ¢ SETUP READY! (Sáºµn sÃ ng tÃ­n hiá»‡u mua)
   â”‚
   â”œâ”€â–º RSI cross up EMA9 (láº§n 2+) â†’ BUY #1 âš ï¸
   â”‚
   â””â”€â–º RSI cross up WMA45 â†’ BUY #2 ğŸ’ª (Reset)
```

### ğŸ”´ SELL SETUP (Trend Reversal Up â†’ Down)

```
Step 1: RSI â‰¤ 20 (Oversold)
   â”‚
   â–¼
Step 2: RSI crossover EMA9
   â”‚  (RSI tÄƒng, cáº¯t lÃªn trÃªn EMA9)
   â–¼
Step 3: RSI crossover WMA45
   â”‚  (RSI tiáº¿p tá»¥c tÄƒng, cáº¯t lÃªn trÃªn WMA45)
   â–¼
Step 4: EMA9 crossover WMA45
   â”‚  (EMA9 cÅ©ng cáº¯t lÃªn trÃªn WMA45)
   â–¼
ğŸ”´ SETUP READY! (Sáºµn sÃ ng tÃ­n hiá»‡u bÃ¡n)
   â”‚
   â”œâ”€â–º RSI cross down EMA9 (láº§n 2+) â†’ SELL #1 âš ï¸
   â”‚
   â””â”€â–º RSI cross down WMA45 â†’ SELL #2 ğŸ’ª (Reset)
```

## ğŸ¯ Ã NghÄ©a TÃ­n Hiá»‡u

| TÃ­n Hiá»‡u | Äá»™ Máº¡nh | Ã NghÄ©a | HÃ nh Äá»™ng |
|----------|---------|---------|-----------|
| ğŸŸ¢ BUY #1 | âš ï¸ Tháº­n trá»ng | RSI báº¯t Ä‘áº§u phá»¥c há»“i sau downtrend | Entry thá»­ nghiá»‡m (position nhá») |
| ğŸŸ¢ BUY #2 | ğŸ’ª Máº¡nh | RSI xÃ¡c nháº­n uptrend, vÆ°á»£t WMA45 | Entry chÃ­nh, add position |
| ğŸ”´ SELL #1 | âš ï¸ Tháº­n trá»ng | RSI báº¯t Ä‘áº§u suy yáº¿u sau uptrend | Take profit má»™t pháº§n |
| ğŸ”´ SELL #2 | ğŸ’ª Máº¡nh | RSI xÃ¡c nháº­n downtrend, phÃ¡ WMA45 | Exit hoÃ n toÃ n, short |

## ğŸ“Š State Management

### BUY State Variables:
```python
buy_step1_touched_overbought    # True náº¿u Ä‘Ã£ cháº¡m â‰¥80
buy_step2_crossed_ema9_down     # True náº¿u RSI Ä‘Ã£ cáº¯t xuá»‘ng EMA9
buy_step3_crossed_wma45_down    # True náº¿u RSI Ä‘Ã£ cáº¯t xuá»‘ng WMA45
buy_step4_ema9_crossed_wma45_down  # True náº¿u EMA9 Ä‘Ã£ cáº¯t xuá»‘ng WMA45
buy_rsi_ema9_cross_count        # Äáº¿m sá»‘ láº§n RSI cáº¯t lÃªn EMA9
buy_entry1_count                # Äáº¿m sá»‘ láº§n BUY #1 (max 2)
```

### SELL State Variables:
```python
sell_step1_touched_oversold     # True náº¿u Ä‘Ã£ cháº¡m â‰¤20
sell_step2_crossed_ema9_up      # True náº¿u RSI Ä‘Ã£ cáº¯t lÃªn EMA9
sell_step3_crossed_wma45_up     # True náº¿u RSI Ä‘Ã£ cáº¯t lÃªn WMA45
sell_step4_ema9_crossed_wma45_up   # True náº¿u EMA9 Ä‘Ã£ cáº¯t lÃªn WMA45
sell_rsi_ema9_cross_count       # Äáº¿m sá»‘ láº§n RSI cáº¯t xuá»‘ng EMA9
sell_entry1_count               # Äáº¿m sá»‘ láº§n SELL #1 (max 2)
```

## ğŸ”„ Reset Conditions

### BUY Setup Reset khi:
- CÃ³ tÃ­n hiá»‡u BUY #2 (hoÃ n thÃ nh chu ká»³)
- RSI cháº¡m vÃ¹ng oversold (â‰¤20) - chu ká»³ bá»‹ giÃ¡n Ä‘oáº¡n

### SELL Setup Reset khi:
- CÃ³ tÃ­n hiá»‡u SELL #2 (hoÃ n thÃ nh chu ká»³)
- RSI cháº¡m vÃ¹ng overbought (â‰¥80) - chu ká»³ bá»‹ giÃ¡n Ä‘oáº¡n

## âš¡ Performance & Optimization

### API Calls per Check:
```
2 symbols Ã— 2 timeframes = 4 API calls/check

Example with CHECK_INTERVAL = 300s (5 min):
- Checks per day: 24h Ã— 60min / 5min = 288
- API calls per day: 288 Ã— 4 = 1,152 requests

Twelve Data Free Tier: 800 requests/day
â†’ Need to optimize! Use CHECK_INTERVAL â‰¥ 420s (7 min)
```

### Recommended Settings:
```python
# config.py
CHECK_INTERVAL = 420  # 7 minutes
# 205 checks/day Ã— 4 = 820 requests/day âœ…

# Or reduce to 1 timeframe per symbol:
TIMEFRAMES = ['1h']  # Only 1h
# 205 checks/day Ã— 2 = 410 requests/day âœ…âœ…
```

## ğŸ“¦ Files & Responsibilities

| File | TrÃ¡ch Nhiá»‡m |
|------|-------------|
| `bot.py` | Main logic, Telegram handlers, job scheduler |
| `rsi_indicator.py` | RSI calculation, signal detection, state management |
| `exchange_client.py` | Fetch data from Binance & Twelve Data |
| `config.py` | Configuration, environment variables |
| `requirements.txt` | Python dependencies |
| `Procfile` | Railway start command |
| `railway.json` | Railway deployment config |
| `setup.py` | Interactive setup wizard |

## ğŸ“ Giáº£i ThÃ­ch Logic Crossover

### Crossover vs Crossunder:

**Crossover** (Cáº¯t lÃªn):
```
prev: A < B
curr: A â‰¥ B
â†’ A vá»«a cáº¯t LÃŠN B
```

**Crossunder** (Cáº¯t xuá»‘ng):
```
prev: A â‰¥ B
curr: A < B
â†’ A vá»«a cáº¯t XUá»NG B
```

### VÃ­ dá»¥ thá»±c táº¿:

```
Time  RSI   EMA9  Event
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
t0:   45    50    (RSI dÆ°á»›i EMA9)
t1:   48    50    (RSI Ä‘ang tÄƒng)
t2:   52    50    (Crossover! RSI cáº¯t lÃªn EMA9)
t3:   55    51    (RSI trÃªn EMA9)
t4:   48    52    (Crossunder! RSI cáº¯t xuá»‘ng EMA9)
```

## ğŸš¦ Signal Flow Example

```
Scenario: BTC/USD 15m - BUY Setup

Hour 1: RSI = 85 â†’ Step 1 âœ“ (touched overbought)
Hour 2: RSI = 75, EMA9 = 78 â†’ Step 2 âœ“ (RSI cut down EMA9)
Hour 3: RSI = 65, WMA45 = 70 â†’ Step 3 âœ“ (RSI cut down WMA45)
Hour 4: EMA9 = 67, WMA45 = 68 â†’ Step 4 âœ“ (EMA9 cut down WMA45)

ğŸŸ¢ SETUP READY!

Hour 5: RSI = 55, EMA9 = 58 â†’ Cross count = 1 (no signal yet)
Hour 6: RSI = 60, EMA9 = 58 â†’ Cross count = 2 â†’ ğŸŸ¢ BUY #1 âš ï¸
Hour 7: RSI = 62, EMA9 = 59 â†’ (monitoring...)
Hour 8: RSI = 71, WMA45 = 68 â†’ ğŸŸ¢ BUY #2 ğŸ’ª (Reset all states)
```

---

**Hiá»ƒu rÃµ logic â†’ Sá»­ dá»¥ng hiá»‡u quáº£! ğŸ¯**
